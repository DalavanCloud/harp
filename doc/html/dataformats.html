

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Data formats &mdash; HARP 0.1b documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
    <link rel="top" title="HARP 0.1b documentation" href="index.html"/>
        <link rel="next" title="Ingestion definitions" href="ingestions/index.html"/>
        <link rel="prev" title="Installation" href="install.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> HARP
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Data formats</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#harp-data-format">HARP data format</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#file-naming">File naming</a></li>
<li class="toctree-l3"><a class="reference internal" href="#global-attributes">Global attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dimensions">Dimensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#variable-attributes">Variable attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#variables">Variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#collocation-result-file-format">Collocation result file format</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ingestions/index.html">Ingestion definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="libharp.html">C library</a></li>
<li class="toctree-l1"><a class="reference internal" href="harpcheck.html">harpcheck</a></li>
<li class="toctree-l1"><a class="reference internal" href="harpcollocate.html">harpcollocate</a></li>
<li class="toctree-l1"><a class="reference internal" href="harpconvert.html">harpconvert</a></li>
<li class="toctree-l1"><a class="reference internal" href="harpdump.html">harpdump</a></li>
<li class="toctree-l1"><a class="reference internal" href="harpfilter.html">harpfilter</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">HARP</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Data formats</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="data-formats">
<h1>Data formats</h1>
<div class="section" id="harp-data-format">
<h2>HARP data format</h2>
<p>The HARP Data Format is a set of conventions for files in netCDF3, HDF4, or HDF5 format. For performance and sizing reasons it is recommended to use netCDF3. The netCDF4 format actually uses HDF5 underneath and is therefore supported as an HDF5 file by HARP.</p>
<p>The HARP conventions can generally be combined with other conventions that do not contradict it. For instance, a file can be compliant with both netCDF-CF and the HARP format convention at the same time.</p>
<p>In order for a product to be compliant with the HARP data format conventions it will need to have the <code class="docutils literal"><span class="pre">HARP-1.0</span></code> value in the <code class="docutils literal"><span class="pre">Conventions</span></code> global attribute and follow the restrictions as described in this section.</p>
<div class="section" id="file-naming">
<h3>File naming</h3>
<p>HARP puts no restrictions on the filename.</p>
</div>
<div class="section" id="global-attributes">
<h3>Global attributes</h3>
<p>The HARP format has the following global attributes</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">Conventions</span></code></dt>
<dd>This attribute should follow the netCDF convention and should contain <code class="docutils literal"><span class="pre">HARP-1.0</span></code> in its value to indicate that the file conforms to the HARP format convention.</dd>
<dt><code class="docutils literal"><span class="pre">history</span></code> (optional)</dt>
<dd>This attribute is used by all HARP tools to keep a trace of the operations performed on a product. Each time a command is performed on a HARP file the full command line is appended to this attribute (using a newline separator between commands). This usage is in line with the general conventions for this attribute.</dd>
<dt><code class="docutils literal"><span class="pre">source_product</span></code> (optional)</dt>
<dd>This attribute will hold the name of the original product in case the HARP file was converted using <code class="docutils literal"><span class="pre">harpconvert</span></code>. This approach makes it possible to use your own file naming approach for HARP files without losing trace of which original product files the data came from.</dd>
<dt><code class="docutils literal"><span class="pre">datetime_start</span></code> (optional)</dt>
<dd>This attribute is mandatory if the file is to be used with <code class="docutils literal"><span class="pre">harpcollocate</span></code>. It will allow for a quick extraction of the time range of the product.
The attribute should be a scalar double precision floating point value giving the <code class="docutils literal"><span class="pre">datetime</span></code> of the first measurement as <code class="docutils literal"><span class="pre">days</span> <span class="pre">since</span> <span class="pre">2000-01-01</span></code> (using the fractional part to represent time-of-day).</dd>
<dt><code class="docutils literal"><span class="pre">datetime_stop</span></code> (optional)</dt>
<dd>This attribute is mandatory if the file is to be used with <code class="docutils literal"><span class="pre">harpcollocate</span></code>. It will allow for a quick extraction of the time range of the product.
The attribute should be a scalar double precision floating point value giving the <code class="docutils literal"><span class="pre">datetime</span></code> of the last measurement as <code class="docutils literal"><span class="pre">days</span> <span class="pre">since</span> <span class="pre">2000-01-01</span></code> (using the fractional part to represent time-of-day).</dd>
</dl>
</div>
<div class="section" id="dimensions">
<h3>Dimensions</h3>
<p>HARP has strict rules regarding the dimensions of variables. Each dimension of a variable can either be associated with an axis (such as time, latitude, longitude, height/depth, etc.) or can be an independent dimension.
All dimensions need to be named. When using netCDF this is alread enforced by the netCDF format itself. For HDF4 and HDF5 the dimension names are stored per variable by means of the <code class="docutils literal"><span class="pre">dims</span></code> variable attribute.</p>
<p>Only dimensions that are supported by HARP can be used. These dimensions are:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">time</span></code> : temporal dimension; this is also the only appendable dimension</li>
<li><code class="docutils literal"><span class="pre">vertical</span></code> : vertical axis, indicating height or depth</li>
<li><code class="docutils literal"><span class="pre">spectral</span></code> : spectral axis, associated with wavelength, wavenumber, or frequency</li>
<li><code class="docutils literal"><span class="pre">latitude</span></code> : latitude axis, only to be used for the latitude axis of a regular latitude x longitude grid</li>
<li><code class="docutils literal"><span class="pre">longitude</span></code> : longitude axis, only to be used for the longitude axis of a regular latitude x longitude grid</li>
<li><code class="docutils literal"><span class="pre">independent_x</span></code> : independent axis of length <code class="docutils literal"><span class="pre">x</span></code> (the length needs be provided as an integer number without leading zeroes);  all independent axis of the same length share the same dimension name; for instance, an independent dimension with length 16 will be named <code class="docutils literal"><span class="pre">independent_16</span></code>.</li>
</ul>
</div></blockquote>
<p>A variable that has more than one dimension will have to use a fixed ordering of the dimensions. In the HARP documentation the ordering is always documented using the so-called &#8216;C convention&#8217; for dimension ordering. With the C convention the last dimension (writing from left to right) is fastest running when enumerating all elements, compared to the Fortran convention, where the first dimension is fastest running. Note that different file access libraries may have different conventions with regard to how they deal with array ordering in their function interfaces.</p>
<dl class="docutils">
<dt>The order in which dimensions need to be provided for a variable is defined by the following rules:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">time</span></code>, if present, is always the first (i.e. slowest running) dimension</li>
<li>next are categorial dimensions used for grouping. For instance, this can be the <code class="docutils literal"><span class="pre">spectral</span></code> dimension when it is used to distinguish between retrievals done using different choices of wavelength, or to distinguish data from different spectral bands.</li>
<li>next are the spatial dimensions, ordered as <code class="docutils literal"><span class="pre">latitude</span></code>, <code class="docutils literal"><span class="pre">longitude</span></code>, <code class="docutils literal"><span class="pre">vertical</span></code></li>
<li>next is the <code class="docutils literal"><span class="pre">spectral</span></code> dimension if used as an actual axis (e.g. for L1 spectral data for instruments that measure along a spectral axis)</li>
<li>all independent dimensions come last (i.e. they will allways be the fastest running dimensions)</li>
</ul>
</dd>
</dl>
<p>So, for a spectral axis used for grouping the overall ordering should be:</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">time</span></code>, <code class="docutils literal"><span class="pre">spectral</span></code>, <code class="docutils literal"><span class="pre">latitude</span></code>, <code class="docutils literal"><span class="pre">longitude</span></code>, <code class="docutils literal"><span class="pre">vertical</span></code>, <code class="docutils literal"><span class="pre">independent</span></code></div></blockquote>
<p>And for a spectral axis used for L1 data from spectral instruments the ordering should be:</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">time</span></code>, <code class="docutils literal"><span class="pre">latitude</span></code>, <code class="docutils literal"><span class="pre">longitude</span></code>, <code class="docutils literal"><span class="pre">vertical</span></code>, <code class="docutils literal"><span class="pre">spectral</span></code>, <code class="docutils literal"><span class="pre">independent</span></code></div></blockquote>
<p>A variable should only use dimensions on which it is dependent. This means that the radiance variable for L1 data of a nadir looking spectral instrument on a satellite will generally only have the dimensions <code class="docutils literal"><span class="pre">time</span></code> and <code class="docutils literal"><span class="pre">spectral</span></code> (and not <code class="docutils literal"><span class="pre">latitude</span></code>, <code class="docutils literal"><span class="pre">longitude</span></code>, <code class="docutils literal"><span class="pre">vertical</span></code>, or <code class="docutils literal"><span class="pre">independent</span></code>).</p>
<p>Note that you can only use a single grid for each type of dimension per time value.
This means that you can switch e.g. the vertical grid from measurement to measurement, but you cannot use two different vertical grids for a single measurement. To change your vertical grid per sample, your <code class="docutils literal"><span class="pre">altitude</span></code> variable can have dimensions <code class="docutils literal"><span class="pre">[time,vertical]</span></code> and the altitude grid for the first sample <code class="docutils literal"><span class="pre">altitude[0,:]</span></code> can differ from that of the second sample <code class="docutils literal"><span class="pre">altitude[1,:]</span></code>. However, an averaging kernel for the first sample that has dimensions <code class="docutils literal"><span class="pre">[time,vertical,vertical]</span></code> will need to use the same altitude grid <code class="docutils literal"><span class="pre">altitude[0,:]</span></code> for both its vertical dimensions.
A grid that differs per sample can have a different effective length per sample. This is done by taking the maximum length for all samples as the real length of the dimension and filling out the dimension for each sample at the end with &#8216;invalid&#8217; values (e.g. <code class="docutils literal"><span class="pre">NaN</span></code>). For instance, you can have an <code class="docutils literal"><span class="pre">altitude[time,vertical]</span></code> where <code class="docutils literal"><span class="pre">altitude[0,:]</span></code> has 7 levels and equals <code class="docutils literal"><span class="pre">[0,</span> <span class="pre">5,</span> <span class="pre">10,</span> <span class="pre">15,</span> <span class="pre">20,</span> <span class="pre">25,</span> <span class="pre">30]</span></code> and <code class="docutils literal"><span class="pre">altitude[1,:]</span></code> has only 6 levels and equals <code class="docutils literal"><span class="pre">[0,</span> <span class="pre">6,</span> <span class="pre">12,</span> <span class="pre">18,</span> <span class="pre">24,</span> <span class="pre">30,</span> <span class="pre">NaN]</span></code>. Operations in HARP will determine the effective length of a dimension for a sample by discarding all trailing NaN values of the axis variable that is used for the operation (e.g. <code class="docutils literal"><span class="pre">altitude</span></code>/<code class="docutils literal"><span class="pre">pressure</span></code> variable for a vertical dimension or <code class="docutils literal"><span class="pre">wavelength</span></code>/<code class="docutils literal"><span class="pre">wavenumber</span></code> variable for a spectral dimension).</p>
<p>Note that even though the <code class="docutils literal"><span class="pre">time</span></code> dimension is considered conceptually <cite>appendable</cite>, this dimension is not stored as an actual appendable dimension in netCDF/HDF4/HDF5. Products are read/written from/to files in full and are only modified in memory. The <cite>appendable</cite> aspect is only something that  counts for e.g. tools such as plotting routines that combine the data from a series of HARP products in order to provide plots/statistics for a whole dataset (and thus, where data from different files will have to be concatenated). Furthermore, storing data in a netcdf file using an actual appendable dimension (using the netCDF definition of <cite>appendable dimension</cite>) will have a slightly lower read/write performance compared to having all dimensions fixed.</p>
</div>
<div class="section" id="variable-attributes">
<h3>Variable attributes</h3>
<dl class="docutils">
<dt>description (optional)</dt>
<dd>This attribute provides a human readable description of the content of the variable. It should make clear what the source of the data was (e.g. measured, climatology, derived, etc.)</dd>
<dt>units (optional)</dt>
<dd>This attribute for data that has a physical unit. It should provide the unit in a form compatible with the <code class="docutils literal"><span class="pre">udunits2</span></code> software.</dd>
<dt>valid_min (optional)</dt>
<dd>Provides the minimum value below which the data is to be considered invalid. Note that this attribute should only be used in case the variable actually contains values below this threshold that are to be interpreted as <cite>missing</cite> or <cite>invalid</cite> values.</dd>
<dt>valid_max (optional)</dt>
<dd>Provides the maximum value above which the data is to be considered invalid. Note that this attribute should only be used in case the variable actually contains values above this threshold that are to be interpreted as <cite>missing</cite> or <cite>invalid</cite> values.</dd>
</dl>
<p>Note that <code class="docutils literal"><span class="pre">_FillValue</span></code> is not used by HARP. Wheter a measurement value is valid or not is purely determined by the <code class="docutils literal"><span class="pre">valid_min</span></code> and <code class="docutils literal"><span class="pre">valid_max</span></code> attributes.</p>
</div>
<div class="section" id="variables">
<h3>Variables</h3>
<p>In order for HARP to perform operations on the data it imposes a strict naming convention for variables. This naming convention is to be applied on the variable name itself and is therefore fully complementary to naming conventions for variable attribute values such as <code class="docutils literal"><span class="pre">standard_name</span></code> (as specified by netCDF-CF).</p>
<p>The list below provides the set of names currently defined by HARP.</p>
<p>The core variables are:</p>
<ul class="simple">
<li>absorbing_aerosol_index</li>
<li>aerosol_extinction_coefficient</li>
<li>aerosol_optical_depth</li>
<li>altitude</li>
<li>altitude_bounds</li>
<li>cloud_fraction</li>
<li>cloud_optical_thickness</li>
<li>cloud_top_albedo</li>
<li>cloud_top_height</li>
<li>cloud_top_pressure</li>
<li>surface_albedo</li>
<li>surface_pressure</li>
<li>collocation_index</li>
<li>datetime</li>
<li>datetime_start</li>
<li>datetime_stop</li>
<li>datetime_length</li>
<li>flag_am_pm</li>
<li>flag_day_twilight_night</li>
<li>frequency</li>
<li>geopotential_height</li>
<li>index</li>
<li>instrument_altitude</li>
<li>instrument_latitude</li>
<li>instrument_longitude</li>
<li>instrument_name</li>
<li>latitude</li>
<li>latitude_bounds</li>
<li>longitude</li>
<li>longitude_bounds</li>
<li>normalized_radiance</li>
<li>number_density</li>
<li>pressure</li>
<li>radiance</li>
<li>reflectance</li>
<li>relative_humidity</li>
<li>relative_azimuth_angle</li>
<li>scan_direction</li>
<li>scan_subset_counter</li>
<li>scanline_pixel_index</li>
<li>scattering_angle</li>
<li>site_name</li>
<li>solar_azimuth_angle</li>
<li>solar_elevation_angle</li>
<li>solar_irradiance</li>
<li>solar_zenith_angle</li>
<li>temperature</li>
<li>viewing_azimuth_angle</li>
<li>viewing_zenith_angle</li>
<li>virtual_temperature</li>
<li>wavelength</li>
<li>wavenumber</li>
<li>&lt;species&gt;_column_number_density</li>
<li>&lt;species&gt;_density</li>
<li>&lt;species&gt;_mass_mixing_ratio</li>
<li>&lt;species&gt;_mass_mixing_ratio_wet</li>
<li>&lt;species&gt;_number_density</li>
<li>&lt;species&gt;_partial_pressure</li>
<li>&lt;species&gt;_volume_mixing_ratio</li>
</ul>
<p>with supported species:</p>
<ul class="simple">
<li>BrO</li>
<li>C2H2</li>
<li>C2H6</li>
<li>CCl2F2</li>
<li>CCl3F</li>
<li>CF4</li>
<li>CH2O</li>
<li>CH3Cl</li>
<li>CH4</li>
<li>CHF2Cl</li>
<li>ClNO</li>
<li>ClONO2</li>
<li>ClO</li>
<li>CO2</li>
<li>COF2</li>
<li>CO</li>
<li>H2O_161</li>
<li>H2O_162</li>
<li>H2O_171</li>
<li>H2O_181</li>
<li>H2O2</li>
<li>H2O</li>
<li>HCl</li>
<li>HCN</li>
<li>HCOOH</li>
<li>HF</li>
<li>HO2NO2</li>
<li>HO2</li>
<li>HOCl</li>
<li>HNO3</li>
<li>N2O</li>
<li>N2O5</li>
<li>N2</li>
<li>NO2</li>
<li>NO3</li>
<li>NO</li>
<li>O2</li>
<li>O3_666</li>
<li>O3_667</li>
<li>O3_668</li>
<li>O3_686</li>
<li>O3</li>
<li>O4</li>
<li>OBrO</li>
<li>OClO</li>
<li>OCS</li>
<li>OH</li>
<li>SF6</li>
<li>SO2</li>
</ul>
<p>Specific height variants of the above variables:</p>
<ul class="simple">
<li>instrument_&lt;variable&gt;</li>
<li>stratospheric_&lt;variable&gt;</li>
<li>surface_&lt;variable&gt;</li>
<li>toa_&lt;variable&gt;</li>
<li>tropospheric_&lt;variable&gt;</li>
</ul>
<p>Specific ancillary variables for the atmospheric variables are:</p>
<ul class="simple">
<li>&lt;variable&gt;_apriori</li>
<li>&lt;variable&gt;_amf</li>
<li>&lt;variable&gt;_avk</li>
</ul>
<p>Generic ancillary variables for the above variables are:</p>
<ul class="simple">
<li>&lt;variable&gt;_cov</li>
<li>&lt;variable&gt;_cov_random</li>
<li>&lt;variable&gt;_cov_systematic</li>
<li>&lt;variable&gt;_stdev</li>
<li>&lt;variable&gt;_stdev_random</li>
<li>&lt;variable&gt;_stdev_systematic</li>
<li>&lt;variable&gt;_validity</li>
</ul>
</div>
</div>
<div class="section" id="collocation-result-file-format">
<h2>Collocation result file format</h2>
<p>The collocation result file is a simple comma separated (csv) file, containing the following columns:</p>
<dl class="docutils">
<dt>collocation_id</dt>
<dd>Unique id of the collocation pair. This id will correspond with the <code class="docutils literal"><span class="pre">collocation_index</span></code> variable inside HARP products after they are filtered using a collocation result file.</dd>
<dt>filename_a</dt>
<dd>The filename of the original input file (i.e. <code class="docutils literal"><span class="pre">source_product</span></code> global attribute value) from the primary dataset.</dd>
<dt>measurement_id_a</dt>
<dd>A unique index number of the measurement within the file. This index number is based on the list of measurements from the original input file and corresponds to the <code class="docutils literal"><span class="pre">index</span></code> variable inside HARP products.</dd>
<dt>filename_b</dt>
<dd>The filename of the original input file (i.e. <code class="docutils literal"><span class="pre">source_product</span></code> global attribute value) from the secondary dataset.</dd>
<dt>measurement_id_b</dt>
<dd>A unique index number of the measurement within the file. This index number is based on the list of measurements from the original input file and corresponds to the <code class="docutils literal"><span class="pre">index</span></code> variable inside HARP products.</dd>
<dt>collocation criteria...</dt>
<dd>The remaining columns cover the collocation criteria that were provided to harpcollocate. For each collocation criterium the column will provide the exact distance value for the given collocated measurement pair for that criterium.</dd>
</dl>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ingestions/index.html" class="btn btn-neutral float-right" title="Ingestion definitions" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="install.html" class="btn btn-neutral" title="Installation" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015 S&amp;T, The Netherlands.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1b',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  false
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>